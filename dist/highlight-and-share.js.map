{"version":3,"file":"highlight-and-share.js","mappings":"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","sources":["webpack://highlight-and-share/./src/frontendjs/highlight-and-share.js"],"sourcesContent":["( function() {\n\t'use strict';\n\n\t// Get localized var.\n\tconst HAS = highlight_and_share;\n\n\t// Set variables.\n\tconst prefix = HAS.prefix;\n\tconst suffix = HAS.suffix;\n\n\tconst isLegacyContentMode = HAS.content_legacy_mode;\n\n\tlet currentElement = null;\n\n\t// Main HAS container in the footer. If \".highlight-and-share-wrapper\" doesn't have this parent, it is a clone.\n\tconst hasContainer = document.querySelector( '#has-highlight-and-share' );\n\tif ( null === hasContainer ) {\n\t\treturn;\n\t}\n\n\tconst socialNetworks =\n\t\t'.has_whatsapp, .has_facebook, .has_twitter, .has_copy, .has_reddit, .has_telegram, .has_linkedin, .has_xing, .has_signal, .has_vk, .has_tumblr, .has_mastodon, .has_email_mailto, .has_email_form';\n\n\t// Get highlight and share container dimensions.\n\tconst hasSharingIconsContainer = hasContainer.querySelector(\n\t\t'.highlight-and-share-wrapper'\n\t);\n\n\t// Populate container dimensions/width/height.\n\tconst rect = hasSharingIconsContainer.getBoundingClientRect();\n\tconst hasSharerWidth = rect.width;\n\tconst hasSharerHeight = rect.height;\n\n\t/**\n\t * Determine if an element is visible or not.\n\t *\n\t * @param {Element} element The element to check if visible or not.\n\t * @return {boolean} true if visible, false if not.\n\t */\n\tconst isVisible = ( element ) => {\n\t\tconst style = window.getComputedStyle( element );\n\t\treturn (\n\t\t\tstyle.display !== 'none' &&\n\t\t\tstyle.visibility !== 'hidden' &&\n\t\t\tstyle.opacity !== '0'\n\t\t);\n\t};\n\n\t/**\n\t * Remove any visible HAS containers.\n\t */\n\tconst hasRemoveVisibleElements = () => {\n\t\tconst hasContainers = document.querySelectorAll(\n\t\t\t'.highlight-and-share-wrapper'\n\t\t);\n\t\tif ( null !== hasContainers ) {\n\t\t\t// Remove visible containers from dom.\n\t\t\thasContainers.forEach( ( container ) => {\n\t\t\t\t// If the container is a clone, remove it. (doesn't have the parent \"#has-highlight-and-share\").\n\t\t\t\tif ( null === container.closest( '#has-highlight-and-share' ) ) {\n\t\t\t\t\tcontainer.remove();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t};\n\n\t/**\n\t * Replace attributes of element and child elements.\n\t *\n\t * @param {Element} element  The element to replace attributes on with child social networks.\n\t * @param {string}  url      The URL of the post/page.\n\t * @param {string}  title    The title of the post/page.\n\t * @param {string}  text     Text that is selected or to be shared\n\t * @param {string}  hashtags Hashtags present on the post/page.\n\t * @param {string}  type     The type of trigger element (inline, selection, cta).\n\t *\n\t * @return {Element} The element with replaced attributes.\n\t *\n\t */\n\tconst hasVariableReplace = ( element, url, title, text, hashtags, type ) => {\n\t\tconst queryElements = element.querySelectorAll( socialNetworks );\n\t\tif ( null === queryElements ) {\n\t\t\treturn element;\n\t\t}\n\n\t\t// Get types mapped for the modal view.\n\t\tlet triggerType = '';\n\t\tif ( 'inline' === type ) {\n\t\t\ttriggerType = 'highlight';\n\t\t} else if ( 'selection' === type ) {\n\t\t\ttriggerType = 'selection';\n\t\t} else if ( 'cta' === type ) {\n\t\t\ttriggerType = 'quote';\n\t\t}\n\n\t\t// Loop through elements.\n\t\tqueryElements.forEach( ( el ) => {\n\t\t\t// Replace attributes in URL.\n\t\t\tconst elementAnchor = el.querySelector( 'a' );\n\t\t\tlet elementUrl = elementAnchor.getAttribute( 'href' );\n\t\t\telementUrl = elementUrl.replace( '%url%', encodeURIComponent( url ) );\n\t\t\telementUrl = elementUrl.replace(\n\t\t\t\t'%username%',\n\t\t\t\tencodeURIComponent( HAS.twitter_username )\n\t\t\t);\n\t\t\telementUrl = elementUrl.replace( '%title%', encodeURIComponent( title ) );\n\t\t\telementUrl = elementUrl.replace( '%text%', encodeURIComponent( text ) );\n\t\t\telementUrl = elementUrl.replace(\n\t\t\t\t'%hashtags%',\n\t\t\t\tencodeURIComponent( hashtags )\n\t\t\t);\n\t\t\telementUrl = elementUrl.replace(\n\t\t\t\t'%type%',\n\t\t\t\tencodeURIComponent( triggerType )\n\t\t\t);\n\t\t\telementUrl = elementUrl.replace( '%prefix%', encodeURIComponent( prefix ) );\n\t\t\telementUrl = elementUrl.replace( '%suffix%', encodeURIComponent( suffix ) );\n\t\t\telementAnchor.setAttribute( 'href', elementUrl );\n\n\t\t\t// Replace the title data attribute.\n\t\t\tlet title_attr = el.getAttribute( 'data-title' );\n\t\t\tif ( null !== title_attr ) {\n\t\t\t\ttitle_attr = title_attr.replace( '%title%', encodeURIComponent( title ) );\n\t\t\t\tel.setAttribute( 'data-title', title_attr );\n\t\t\t}\n\n\t\t\t// Replace the url data attribute.\n\t\t\tlet url_attr = el.getAttribute( 'data-url' );\n\t\t\tif ( null !== url_attr ) {\n\t\t\t\turl_attr = url_attr.replace( '%url%', encodeURIComponent( url ) );\n\t\t\t\tel.setAttribute( 'data-url', url_attr );\n\t\t\t}\n\t\t} );\n\t};\n\n\t/**\n\t * Display the Highlight and Share Interface.\n\t *\n\t * @param {string}  text           Text that is selected or to be shared.\n\t * @param {string}  title          The title of the post/page.\n\t * @param {string}  href           The URL of the post/page.\n\t * @param {string}  hashtags       Hashtags present on the post/page.\n\t * @param {string}  type           The type of display (selection|inline|cta).\n\t * @param {element} triggerElement The event initiator (null if no trigger element).\n\t */\n\tconst hasDisplay = (\n\t\ttext,\n\t\ttitle,\n\t\thref,\n\t\thashtags,\n\t\ttype,\n\t\ttriggerElement = null\n\t) => {\n\t\t// Do not show the interface if nothing is enabled.\n\t\tif (\n\t\t\tfalse === highlight_and_share.show_twitter &&\n\t\t\tfalse === highlight_and_share.show_facebook &&\n\t\t\tfalse === highlight_and_share.show_linkedin &&\n\t\t\tfalse === highlight_and_share.show_ok &&\n\t\t\tfalse === highlight_and_share.show_vk &&\n\t\t\tfalse === highlight_and_share.show_pinterest &&\n\t\t\tfalse === highlight_and_share.show_email &&\n\t\t\tfalse === highlight_and_share.show_webshare &&\n\t\t\tfalse === highlight_and_share.show_mastodon\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove any existing visible interfaces/containers.\n\t\thasRemoveVisibleElements();\n\n\t\t// Get interface clone.\n\t\tconst hasClone = hasContainer\n\t\t\t.querySelector( '.highlight-and-share-wrapper' )\n\t\t\t.cloneNode( true );\n\t\t// Style the interface via inline styles and position.\n\t\thasClone.style.display = 'block';\n\t\thasClone.style.position = 'absolute';\n\t\thasClone.style.width = 'auto';\n\t\thasClone.style.height = 'auto';\n\t\thasClone.style[ 'z-index' ] = 10000;\n\n\t\t// Change to inline flex if vertical.\n\t\tif ( hasClone.classList.contains( 'orientation-vertical' ) ) {\n\t\t\thasClone.style.display = 'inline-flex';\n\t\t}\n\n\t\thasVariableReplace( hasClone, href, title, text, hashtags, type ); // Replaced by reference.\n\n\t\t// Check for webshare. Enable if available.\n\t\tif ( 'undefined' !== typeof navigator.share ) {\n\t\t\tconst webshare = hasClone.querySelector( '.has_webshare' );\n\t\t\tif ( null !== webshare ) {\n\t\t\t\twebshare.style.display = 'inline-block';\n\t\t\t}\n\t\t}\n\n\t\t// Add to the end of the body element.\n\t\tdocument.body.appendChild( hasClone );\n\t\tswitch ( type ) {\n\t\t\tcase 'selection':\n\t\t\t\t// Position the interface.\n\t\t\t\tsetHasContainerPositionSelection( hasClone );\n\t\t\t\tbreak;\n\t\t\tcase 'inline':\n\t\t\t\t// Position the interface.\n\t\t\t\tsetHasContainerPositionInline( hasClone, triggerElement );\n\t\t\t\tbreak;\n\t\t\tcase 'cta':\n\t\t\t\t// Position the interface.\n\t\t\t\tsetHasContainerPositionCta( hasClone, triggerElement );\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Setup event handlers for links (for desktop).\n\t\tconst queryElements = document\n\t\t\t.querySelector( 'body' )\n\t\t\t.querySelectorAll(\n\t\t\t\t'.has_whatsapp, .has_facebook, .has_twitter, .has_telegram, .has_linkedin, .has_xing, .has_reddit, .has_tumblr'\n\t\t\t);\n\t\tif ( null !== queryElements ) {\n\t\t\t// Add click listeners to visible elements.\n\t\t\tqueryElements.forEach( ( el ) => {\n\t\t\t\tif ( isVisible( el ) ) {\n\t\t\t\t\tel.querySelector( 'a' ).addEventListener( 'click', ( event ) => {\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t// Get the URL.\n\t\t\t\t\t\tconst url = el.querySelector( 'a' ).getAttribute( 'href' );\n\n\t\t\t\t\t\t// Set dataLayer event for GTM.\n\t\t\t\t\t\tif ( 'undefined' !== typeof dataLayer ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\tdataLayer.push( {\n\t\t\t\t\t\t\t\tevent: 'highlight-and-share',\n\t\t\t\t\t\t\t\thasShareText: text,\n\t\t\t\t\t\t\t\thasSharePostUrl: href,\n\t\t\t\t\t\t\t\thasSharePostTitle: title,\n\t\t\t\t\t\t\t\thasShareType: type /* selection|cta|inline */,\n\t\t\t\t\t\t\t\thasSocialNetwork: el.getAttribute( 'data-type' ),\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t'Highlight and Share',\n\t\t\t\t\t\t\t'width=575,height=430,toolbar=false,menubar=false,location=false,status=false'\n\t\t\t\t\t\t);\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Set up copy event.\n\t\tconst copyButtons = document.querySelectorAll( '.has_copy' );\n\t\tif ( null !== copyButtons ) {\n\t\t\tcopyButtons.forEach( ( el ) => {\n\t\t\t\tif ( isVisible( el ) ) {\n\t\t\t\t\t// Remove copy element if ClipboardItem is undefined.\n\t\t\t\t\tif ( 'undefined' === typeof ClipboardItem ) {\n\t\t\t\t\t\tel.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tel.addEventListener( 'click', ( event ) => {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t// Make sure ClipboardItem is supported.\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst copyBlob = new Blob( [ text ], { type: 'text/plain' } );\n\t\t\t\t\t\t\t\tconst data = [ new ClipboardItem( { [ copyBlob.type ]: copyBlob } ) ];\n\t\t\t\t\t\t\t\tnavigator.clipboard.write( data );\n\t\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t\t// Copying is not supported on Mozilla (firefox).\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Change tooltip data attribute.\n\t\t\t\t\t\t\tel.setAttribute( 'data-tooltip', 'Copied!' );\n\n\t\t\t\t\t\t\t// Set dataLayer event for GTM.\n\t\t\t\t\t\t\tif ( 'undefined' !== typeof dataLayer ) {\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\t\tdataLayer.push( {\n\t\t\t\t\t\t\t\t\tevent: 'highlight-and-share',\n\t\t\t\t\t\t\t\t\thasShareText: text,\n\t\t\t\t\t\t\t\t\thasSharePostUrl: href,\n\t\t\t\t\t\t\t\t\thasSharePostTitle: title,\n\t\t\t\t\t\t\t\t\thasShareType: type /* selection|cta|inline */,\n\t\t\t\t\t\t\t\t\thasSocialNetwork: 'copy',\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Set up email event.\n\t\tconst emailButtons = document.querySelectorAll( '.has_email_form' );\n\t\tif ( null !== emailButtons ) {\n\t\t\temailButtons.forEach( ( el ) => {\n\t\t\t\tif ( isVisible( el ) ) {\n\t\t\t\t\tel.addEventListener( 'click', ( event ) => {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tconst url = event.target.closest( 'a' ).getAttribute( 'href' );\n\t\t\t\t\t\tif ( 'undefined' !== typeof Fancybox ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\thasRemoveVisibleElements();\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\twindow.highlightShareFancy = new Fancybox(\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tsrc: url,\n\t\t\t\t\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\t\t\t\t\tpreload: true,\n\t\t\t\t\t\t\t\t\t\tcompact: true,\n\t\t\t\t\t\t\t\t\t\tautoFocus: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tToolbar: {\n\t\t\t\t\t\t\t\t\t\tautoEnable: false,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t/**\n\t\t * Set up Mastodon Prompt.\n\t\t */\n\t\tconst mastodonButtons = document.querySelectorAll( '.has_mastodon' );\n\t\tif ( null !== mastodonButtons ) {\n\t\t\tmastodonButtons.forEach( ( el ) => {\n\t\t\t\tif ( isVisible( el ) ) {\n\t\t\t\t\tel.addEventListener( 'click', ( event ) => {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tconst url = event.target.closest( 'a' ).getAttribute( 'href' );\n\t\t\t\t\t\t\n\t\t\t\t\t\t// \n\t\t\t\t\t\tif ( 'undefined' !== typeof Fancybox ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\thasRemoveVisibleElements();\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\twindow.highlightShareFancy = new Fancybox(\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttype: 'inline',\n\t\t\t\t\t\t\t\t\t\tcompact: true,\n\t\t\t\t\t\t\t\t\t\tsrc: '#has-mastodon-prompt',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tToolbar: {\n\t\t\t\t\t\t\t\t\t\tautoEnable: false,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\tdone: () => {\n\t\t\t\t\t\t\t\t\t\t\tconst fancyboxForm = document.querySelector(\n\t\t\t\t\t\t\t\t\t\t\t\t'.has-mastodon-form'\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tconst fancyboxInput = fancyboxForm.querySelector(\n\t\t\t\t\t\t\t\t\t\t\t\t'input'\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tif ( null !== fancyboxInput ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfancyboxInput.focus();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tfancyboxForm.addEventListener( 'submit', ( event ) => {\n\t\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\tconst fancyboxInputValue = fancyboxInput.value;\n\n\t\t\t\t\t\t\t\t\t\t\t\t// Save the value to local storage.\n\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t\t\t\t\t\t\t'highlight-and-share-mastodon',\n\t\t\t\t\t\t\t\t\t\t\t\t\tfancyboxInputValue\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\tlet fancyUrl = url;\n\t\t\t\t\t\t\t\t\t\t\t\tif ( '' !== fancyboxInputValue ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfancyUrl = fancyUrl.replace( /mastodon\\.social/i, fancyboxInputValue );\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log( fancyUrl );\n\n\t\t\t\t\t\t\t\t\t\t\t\t// Now go to URL.\n\t\t\t\t\t\t\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t\t\t\t\t\t\tfancyUrl,\n\t\t\t\t\t\t\t\t\t\t\t\t\t'Highlight and Share',\n\t\t\t\t\t\t\t\t\t\t\t\t\t'width=575,height=430,toolbar=false,menubar=false,location=false,status=false'\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\t\t\t// Get local storage and populate input if available.\n\t\t\t\t\t\t\t\t\t\t\tconst localStorageValue = localStorage.getItem(\n\t\t\t\t\t\t\t\t\t\t\t\t'highlight-and-share-mastodon'\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tif ( null !== localStorageValue ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfancyboxInput.value = localStorageValue;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Set up webshare event.\n\t\tconst webshareButtons = document.querySelectorAll( '.has_webshare' );\n\t\tif ( null !== webshareButtons ) {\n\t\t\twebshareButtons.forEach( ( el ) => {\n\t\t\t\tif ( isVisible( el ) ) {\n\t\t\t\t\tel.addEventListener( 'click', ( event ) => {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tconst url = event.target.closest( 'a' ).getAttribute( 'href' );\n\t\t\t\t\t\tnavigator.share( {\n\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t};\n\n\t/**\n\t * Set the Social Sharer container position for the current selection. This needs to run after cloned element has been appended to the dom.\n\t *\n\t * @param {element} element The cloned social sharer element.\n\t */\n\tconst setHasContainerPositionSelection = ( element ) => {\n\t\t// Get the dimensions of the window.\n\t\tconst windowWidth = window.innerWidth;\n\t\tconst windowHeight = window.innerHeight;\n\n\t\t// Get the dimensions and location of the selection.\n\t\tconst selectionRect = window\n\t\t\t.getSelection()\n\t\t\t.getRangeAt( 0 )\n\t\t\t.getBoundingClientRect();\n\t\tconst selectionTop = selectionRect.top; // top position relative to view port.\n\t\tconst selectionLeft = selectionRect.left; // left position relative to view port.\n\t\tconst selectionWidth = selectionRect.width;\n\t\tconst selectionHeight = selectionRect.height;\n\n\t\t// Set container width to smaller than window width if larger.\n\t\tif ( element.offsetWidth > windowWidth ) {\n\t\t\telement.style.maxWidth = windowWidth - 20 + 'px';\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t}\n\n\t\t// Get the dimensions of the click to share container.\n\t\tconst hasCloneRect = element.getBoundingClientRect();\n\t\tconst hasCloneWidth = hasCloneRect.width;\n\t\tconst hasCloneHeight = hasCloneRect.height;\n\n\t\tif ( element.classList.contains( 'orientation-vertical' ) ) {\n\t\t\t/**\n\t\t\t * Get Vertical position.\n\t\t\t */\n\n\t\t\t// Get the X position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerX = selectionLeft + window.scrollX - ( hasCloneWidth + 15 );\n\t\t\t// Get the Y position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerY =\n\t\t\t\tselectionTop +\n\t\t\t\twindow.scrollY -\n\t\t\t\thasCloneHeight / 2 +\n\t\t\t\tselectionHeight / 2;\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t\t// If clone is outside of viewport, set width.\n\t\t\tif ( selectionTop + window.scrollY - hasCloneHeight / 2 < 0 ) {\n\t\t\t\telement.style.display = 'grid';\n\t\t\t\telement.style.gridTemplateColumns = '1fr 1fr';\n\n\t\t\t\t// Get new clone width dimensions.\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\n\t\t\t\t// calculate left/top position.\n\t\t\t\telement.style.top =\n\t\t\t\t\tselectionTop +\n\t\t\t\t\twindow.scrollY -\n\t\t\t\t\tnewCloneRect.height / 2 +\n\t\t\t\t\tselectionHeight / 2 +\n\t\t\t\t\t'px';\n\t\t\t\telement.style.left =\n\t\t\t\t\tselectionLeft + window.scrollX - newCloneRect.width - 15 + 'px';\n\n\t\t\t\t// Calculate top position.\n\t\t\t} else if ( selectionTop + hasCloneHeight > windowHeight ) {\n\t\t\t\telement.style.display = 'grid';\n\t\t\t\telement.style.gridTemplateColumns = '1fr 1fr';\n\n\t\t\t\t// Get new clone width dimensions.\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\n\t\t\t\t// calculate left/top position.\n\t\t\t\telement.style.top =\n\t\t\t\t\tselectionTop +\n\t\t\t\t\twindow.scrollY -\n\t\t\t\t\tnewCloneRect.height / 2 +\n\t\t\t\t\tselectionHeight / 2 +\n\t\t\t\t\t'px';\n\t\t\t\telement.style.left =\n\t\t\t\t\tselectionLeft + window.scrollX - newCloneRect.width - 15 + 'px';\n\t\t\t} else {\n\t\t\t\telement.style.left = hasSharerX + 'px';\n\t\t\t\telement.style.top = hasSharerY + 'px';\n\t\t\t\telement.classList.remove( 'has-no-margin-bottom' );\n\t\t\t}\n\t\t} else {\n\t\t\t/**\n\t\t\t * Get horizontal position.\n\t\t\t */\n\n\t\t\t// Get the X position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerX =\n\t\t\t\tselectionLeft + window.scrollX + selectionWidth / 2 - hasCloneWidth / 2;\n\t\t\t// Get the Y position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerY = selectionTop + window.scrollY - hasCloneHeight - 15;\n\n\t\t\t// Determine if hasSharerX is outside of view.\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t\tif ( hasSharerX < 0 ) {\n\t\t\t\t// If so, set to 0.\n\t\t\t\telement.style.left = '15px';\n\t\t\t} else if ( hasSharerX + hasSharerWidth > windowWidth ) {\n\t\t\t\t// If so, set to windowWidth - hasSharerWidth.\n\t\t\t\telement.style.right = '15px';\n\t\t\t} else {\n\t\t\t\t// Otherwise, set to hasSharerX.\n\t\t\t\telement.style.left = hasSharerX + 'px';\n\t\t\t\telement.classList.remove( 'has-no-margin-bottom' );\n\t\t\t}\n\n\t\t\t// Set the left,top CSS in the clone.\n\t\t\telement.style.top = hasSharerY + 'px';\n\t\t}\n\t};\n\n\t/**\n\t * Set the Social Sharer container position for the inline highlighter. This needs to run after cloned element has been appended to the dom.\n\t *\n\t * @param {element} element        The cloned social sharer element.\n\t * @param {element} triggerElement The event initiator (null if no trigger element).\n\t */\n\tconst setHasContainerPositionInline = ( element, triggerElement ) => {\n\t\t// Get the dimensions of the window.\n\t\tconst windowWidth = window.innerWidth;\n\t\tconst windowHeight = window.innerHeight;\n\n\t\t// Get the dimensions and location of the selection.\n\t\tconst inlineRect = triggerElement.getBoundingClientRect();\n\t\tconst inlineTop = inlineRect.top; // top position relative to view port.\n\t\tconst inlineLeft = inlineRect.left; // left position relative to view port.\n\t\tconst inlineWidth = inlineRect.width;\n\t\tconst inlineHeight = inlineRect.height;\n\n\t\t// Get the dimensions of the click to share container.\n\t\tconst hasCloneRect = element.getBoundingClientRect();\n\t\tconst hasCloneWidth = hasCloneRect.width;\n\t\tconst hasCloneHeight = hasCloneRect.height;\n\n\t\tif ( element.classList.contains( 'orientation-vertical' ) ) {\n\t\t\t/**\n\t\t\t * Get Vertical position.\n\t\t\t */\n\n\t\t\t// Get the X position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerX = inlineLeft + window.scrollX - ( hasCloneWidth + 15 );\n\t\t\t// Get the Y position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerY =\n\t\t\t\tinlineTop + window.scrollY - hasCloneHeight / 2 + inlineHeight / 2;\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t\t// If clone is outside of viewport, set width.\n\t\t\tif ( inlineTop + window.scrollY - hasCloneHeight / 2 < 0 ) {\n\t\t\t\telement.style.display = 'grid';\n\t\t\t\telement.style.gridTemplateColumns = '1fr 1fr';\n\n\t\t\t\t// Get new clone width dimensions.\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\n\t\t\t\t// calculate left/top position.\n\t\t\t\telement.style.top =\n\t\t\t\t\tinlineTop +\n\t\t\t\t\twindow.scrollY -\n\t\t\t\t\tnewCloneRect.height / 2 +\n\t\t\t\t\tinlineHeight / 2 +\n\t\t\t\t\t'px';\n\t\t\t\tconst leftPosition =\n\t\t\t\t\tinlineLeft + window.scrollX - newCloneRect.width - 15;\n\t\t\t\tif ( leftPosition < 0 ) {\n\t\t\t\t\telement.style.left = '15px';\n\t\t\t\t} else {\n\t\t\t\t\telement.style.left = leftPosition + 'px';\n\t\t\t\t}\n\n\t\t\t\t// Calculate top position.\n\t\t\t} else if ( inlineTop + hasCloneHeight > windowHeight ) {\n\t\t\t\telement.style.display = 'grid';\n\t\t\t\telement.style.gridTemplateColumns = '1fr 1fr';\n\n\t\t\t\t// Get new clone width dimensions.\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\n\t\t\t\t// calculate left/top position.\n\t\t\t\telement.style.top =\n\t\t\t\t\tinlineTop +\n\t\t\t\t\twindow.scrollY -\n\t\t\t\t\tnewCloneRect.height / 2 +\n\t\t\t\t\tinlineHeight / 2 +\n\t\t\t\t\t'px';\n\t\t\t\tconst leftPosition =\n\t\t\t\t\tinlineLeft + window.scrollX - newCloneRect.width - 15;\n\t\t\t\tif ( leftPosition < 0 ) {\n\t\t\t\t\telement.style.left = '15px';\n\t\t\t\t} else {\n\t\t\t\t\telement.style.left = leftPosition + 'px';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\telement.style.left = hasSharerX + 'px';\n\t\t\t\telement.style.top = hasSharerY + 'px';\n\t\t\t\telement.classList.remove( 'has-no-margin-bottom' );\n\t\t\t}\n\t\t} else {\n\t\t\t// Get the X position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerX =\n\t\t\t\tinlineLeft + window.scrollX + inlineWidth / 2 - hasCloneWidth / 2;\n\t\t\t// Get the Y position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerY = inlineTop + window.scrollY - hasCloneHeight - 15;\n\n\t\t\t// Determine if hasSharerX is outside of view.\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t\tif ( hasSharerX < 0 ) {\n\t\t\t\t// If so, set to 0.\n\t\t\t\telement.style.left = '15px';\n\t\t\t} else if ( hasSharerX + hasSharerWidth > windowWidth ) {\n\t\t\t\t// If so, set to windowWidth - hasSharerWidth.\n\t\t\t\telement.style.right = '15px';\n\t\t\t} else {\n\t\t\t\t// Otherwise, set to hasSharerX.\n\t\t\t\telement.style.left = hasSharerX + 'px';\n\t\t\t\telement.classList.remove( 'has-no-margin-bottom' );\n\t\t\t}\n\n\t\t\t// Set the left,top CSS in the clone.\n\t\t\telement.style.top = hasSharerY + 'px';\n\t\t}\n\t};\n\n\t/**\n\t * Set the Social Sharer container position for the inline highlighter. This needs to run after cloned element has been appended to the dom.\n\t *\n\t * @param {element} element        The cloned social sharer element.\n\t * @param {element} triggerElement The event initiator (null if no trigger element).\n\t */\n\tconst setHasContainerPositionCta = ( element, triggerElement ) => {\n\t\t// Get the dimensions of the window.\n\t\tconst windowWidth = window.innerWidth;\n\t\tconst windowHeight = window.innerHeight;\n\n\t\t// Get the dimensions and location of the selection.\n\t\tconst ctaRect = triggerElement.getBoundingClientRect();\n\t\tconst ctaTop = ctaRect.top; // top position relative to view port.\n\t\tconst ctaLeft = ctaRect.left; // left position relative to view port.\n\t\tconst ctaWidth = ctaRect.width;\n\t\tconst ctaHeight = ctaRect.height;\n\n\t\t// Set container width to smaller than window width if larger.\n\t\tif ( element.getBoundingClientRect().width > windowWidth ) {\n\t\t\telement.style.maxWidth = windowWidth - 20 + 'px';\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t}\n\n\t\t// Get the dimensions of the click to share container.\n\t\tconst hasCloneRect = element.getBoundingClientRect();\n\t\tconst hasCloneWidth = hasCloneRect.width;\n\t\tconst hasCloneHeight = hasCloneRect.height;\n\n\t\tif ( element.classList.contains( 'orientation-vertical' ) ) {\n\t\t\t/**\n\t\t\t * Get Vertical position.\n\t\t\t */\n\n\t\t\t// Get the X position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerX = ctaLeft + window.scrollX - ( hasCloneWidth + 15 );\n\t\t\t// Get the Y position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerY =\n\t\t\t\tctaTop + window.scrollY - hasCloneHeight / 2 + ctaHeight / 2;\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t\t// If clone is outside of viewport, set width.\n\t\t\tif ( ctaTop + window.scrollY - hasCloneHeight / 2 < 0 ) {\n\t\t\t\telement.style.display = 'grid';\n\t\t\t\telement.style.gridTemplateColumns = '1fr 1fr';\n\n\t\t\t\t// Get new clone width dimensions.\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\n\t\t\t\t// calculate left/top position.\n\t\t\t\telement.style.top =\n\t\t\t\t\tctaTop +\n\t\t\t\t\twindow.scrollY -\n\t\t\t\t\tnewCloneRect.height / 2 +\n\t\t\t\t\tctaHeight / 2 +\n\t\t\t\t\t'px';\n\t\t\t\tconst leftPosition = ctaLeft + window.scrollX - newCloneRect.width - 15;\n\t\t\t\tif ( leftPosition < 0 ) {\n\t\t\t\t\telement.style.left = '15px';\n\t\t\t\t} else {\n\t\t\t\t\telement.style.left = leftPosition + 'px';\n\t\t\t\t}\n\n\t\t\t\t// Calculate top position.\n\t\t\t} else if ( ctaTop + hasCloneHeight > windowHeight ) {\n\t\t\t\telement.style.display = 'grid';\n\t\t\t\telement.style.gridTemplateColumns = '1fr 1fr';\n\n\t\t\t\t// Get new clone width dimensions.\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\n\t\t\t\t// calculate left/top position.\n\t\t\t\telement.style.top =\n\t\t\t\t\tctaTop +\n\t\t\t\t\twindow.scrollY -\n\t\t\t\t\tnewCloneRect.height / 2 +\n\t\t\t\t\tctaHeight / 2 +\n\t\t\t\t\t'px';\n\t\t\t\tconst leftPosition = ctaLeft + window.scrollX - newCloneRect.width - 15;\n\t\t\t\tif ( leftPosition < 0 ) {\n\t\t\t\t\telement.style.left = '15px';\n\t\t\t\t} else {\n\t\t\t\t\telement.style.left = leftPosition + 'px';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst newCloneRect = element.getBoundingClientRect();\n\t\t\t\telement.style.left =\n\t\t\t\t\tctaLeft + window.scrollX - newCloneRect.width - 15 + 'px';\n\t\t\t\telement.style.top = hasSharerY + 'px';\n\t\t\t\telement.classList.remove( 'has-no-margin-bottom' );\n\t\t\t}\n\t\t} else {\n\t\t\t// Get the X position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerX =\n\t\t\t\tctaLeft + window.scrollX + ctaWidth / 2 - hasCloneWidth / 2;\n\t\t\t// Get the Y position of where the HAS Sharer inteface should be displayed.\n\t\t\tconst hasSharerY = ctaTop + window.scrollY - hasCloneHeight - 15;\n\n\t\t\t// Determine if hasSharerX is outside of view.\n\t\t\telement.classList.add( 'has-no-margin-bottom' );\n\t\t\tif ( hasSharerX < 0 ) {\n\t\t\t\t// If so, set to 0.\n\t\t\t\telement.style.left = '15px';\n\t\t\t} else if ( hasSharerX + hasSharerWidth > windowWidth ) {\n\t\t\t\t// If so, set to windowWidth - hasSharerWidth.\n\t\t\t\telement.style.right = '15px';\n\t\t\t} else {\n\t\t\t\t// Otherwise, set to hasSharerX.\n\t\t\t\telement.style.left = hasSharerX + 'px';\n\t\t\t\telement.classList.remove( 'has-no-margin-bottom' );\n\t\t\t}\n\n\t\t\t// Set the left,top CSS in the clone.\n\t\t\telement.style.top = hasSharerY + 'px';\n\t\t}\n\t};\n\n\t/**\n\t * Get the page parameters.\n\t *\n\t * @param {Element} newElement Element to retrieve data functions for.\n\t *\n\t * @return {Object} Object containing the page parameters.\n\t */\n\tconst getPageParams = ( newElement ) => {\n\t\tconst href =\n\t\t\tnull !== newElement\n\t\t\t\t? newElement.dataset.url\n\t\t\t\t: window.location.href;\n\t\tconst title =\n\t\t\tnull !== newElement ? newElement.dataset.title : document.title;\n\t\tconst hashtags =\n\t\t\tnull !== newElement ? newElement.dataset.hashtags : '';\n\t\tconst params = {};\n\n\t\tparams.href = href;\n\t\tparams.title = title;\n\t\tparams.hashtags = hashtags;\n\n\t\treturn params;\n\t};\n\n\t// Begin setting up events.\n\n\t// Get JS Content and return if not set.\n\tconst jsContent = HAS.content;\n\tif ( '' === jsContent ) {\n\t\treturn;\n\t}\n\n\t// Get all elements matching jsContent. Set up events.\n\tconst elements = document.querySelectorAll( jsContent );\n\tif ( null !== elements ) {\n\t\t/**\n\t\t * Handle touch/click events for select (mouseup) events.\n\t\t *\n\t\t * @param {event}   event         The original event.\n\t\t * @param {element} parentElement The element to retrieve data functions for.\n\t\t */\n\t\tconst hasHandleSelectEvents = ( event, parentElement ) => {\n\t\t\t// Remove any visible elements.\n\t\t\thasRemoveVisibleElements();\n\n\t\t\t// Get selection.\n\t\t\tconst selection = document.defaultView.getSelection();\n\n\t\t\t// Get the selected text.\n\t\t\tconst selectedText = selection.toString().trim();\n\n\t\t\tif ( '' === selectedText ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst element = parentElement.querySelector( '.has-social-placeholder' );\n\n \t\t\t// Get the highlight and share params.\n\t\t\tconst { href, title, hashtags } = getPageParams( element );\n\n\t\t\t// Display Highlight and Share.\n\t\t\thasDisplay( selectedText, title, href, hashtags, 'selection' );\n\t\t};\n\t\t// Loop through elements and set up mouseup event.\n\t\telements.forEach( ( element ) => {\n\t\t\t// element.addEventListener( 'touchcancel', ( event ) => {  // This partially works on Android, but only for the first word. Selections do not work. Android is currently not supported. iOS still works.\n\t\t\t// \thasHandleSelectEvents( event );\n\t\t\t// } );\n\n\t\t\t// Check if element has class `has-content-area` and if so, it's flush with the content. Select its parent, and add the event to that.\n\t\t\tif ( element.classList.contains( 'has-content-area' ) && ! isLegacyContentMode ) {\n\t\t\t\telement.parentElement.addEventListener( 'mouseup', ( event ) => {\n\t\t\t\t\thasHandleSelectEvents( event, element.parentElement );\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Add the rest of the elements.\n\t\t\telement.addEventListener( 'mouseup', ( event ) => {\n\t\t\t\thasHandleSelectEvents( event, element );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// Get inline elements.\n\tconst inlineElements = document.querySelectorAll( '.has-inline-text' );\n\tif ( null !== inlineElements ) {\n\t\t/**\n\t\t * Handle touch/click events for inline highlighting.\n\t\t *\n\t\t * @param {event}   event   The original event.\n\t\t * @param {element} element The element the event happened on.\n\t\t */\n\t\tconst hasHandleInlineEvents = ( event, element ) => {\n\t\t\t// Remove any visible elements.\n\t\t\thasRemoveVisibleElements();\n\n\t\t\t// Exit early if the element is already visible (works like a toggle).\n\t\t\tif ( element === currentElement ) {\n\t\t\t\tcurrentElement = null;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcurrentElement = element;\n\n\t\t\t// Get selected text.\n\t\t\tconst selectedText = element.innerText.trim();\n\n\t\t\tif ( '' === selectedText ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst elementParent = event.target.closest( '.has-social-placeholder' );\n\t\t\tconst { href, title, hashtags } = getPageParams( elementParent );\n\n\t\t\t/**\n\t\t\t * See if we can launch the web share API by default on inline highlight click.\n\t\t\t */\n\t\t\tconst webshareDefaultInlineHighlight = HAS.enable_webshare_inline_highlight;\n\t\t\tif ( webshareDefaultInlineHighlight ) {\n\t\t\t\t// Check if navigator.share is available.\n\t\t\t\tif ( typeof navigator.share === 'function' ) {\n\t\t\t\t\tnavigator.share( {\n\t\t\t\t\t\ttitle,\n\t\t\t\t\t\turl: href,\n\t\t\t\t\t\ttext: selectedText,\n\t\t\t\t\t} );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Display Highlight and Share.\n\t\t\thasDisplay( selectedText, title, href, hashtags, 'inline', element );\n\t\t};\n\t\tinlineElements.forEach( ( element ) => {\n\t\t\t// Add tooltips to inline highlight as a data attribute.\n\t\t\tif (\n\t\t\t\thighlight_and_share.inline_highlight_tooltips_enabled &&\n\t\t\t\t'' !== highlight_and_share.inline_highlight_tooltips_text\n\t\t\t) {\n\t\t\t\telement.setAttribute(\n\t\t\t\t\t'data-tooltip',\n\t\t\t\t\thighlight_and_share.inline_highlight_tooltips_text\n\t\t\t\t);\n\t\t\t}\n\t\t\t// For mouse and trackpad.\n\t\t\telement.addEventListener( 'click', ( event ) => {\n\t\t\t\thasHandleInlineEvents( event, element );\n\t\t\t\tconst tooltip = document.querySelectorAll( '.has-inline-text-tooltip' );\n\t\t\t\tif ( null !== tooltip ) {\n\t\t\t\t\ttooltip.forEach( ( tooltipElement ) => {\n\t\t\t\t\t\ttooltipElement.remove();\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// For hover effect on desktop devices.\n\t\t\telement.addEventListener( 'mouseover', ( event ) => {\n\t\t\t\t// Check if element has data-tooltip attribute.\n\t\t\t\tif ( element.hasAttribute( 'data-tooltip' ) ) {\n\t\t\t\t\t// Get position and dimensions of highlighted element.\n\t\t\t\t\tconst elementRect = event.target.getBoundingClientRect();\n\n\t\t\t\t\t// Set tooltip position.\n\t\t\t\t\tconst elementTop = elementRect.top;\n\t\t\t\t\tconst tooltipWidth = 120; // Adjust to desired width of tooltip\n\t\t\t\t\tconst tooltipHeight = 30; // Adjust to desired height of tooltip\n\t\t\t\t\tconst scrollX = window.scrollX;\n\t\t\t\t\tconst scrollY = window.scrollY;\n\n\t\t\t\t\t// Calculate tooltip position based on element position, window size, and scroll position.\n\t\t\t\t\tconst tooltipLeft = event.clientX - tooltipWidth / 2 + scrollX;\n\t\t\t\t\tconst tooltipTop = elementTop - tooltipHeight + scrollY - 10;\n\n\t\t\t\t\t// Create div element to hold tooltip.\n\t\t\t\t\tconst tooltip = document.createElement( 'div' );\n\t\t\t\t\ttooltip.classList.add( 'has-inline-text-tooltip' );\n\t\t\t\t\ttooltip.style.position = 'absolute';\n\t\t\t\t\ttooltip.style.left = tooltipLeft + 'px';\n\t\t\t\t\ttooltip.style.top = tooltipTop + 'px';\n\t\t\t\t\ttooltip.innerText = element.getAttribute( 'data-tooltip' );\n\n\t\t\t\t\t// Add tooltip to DOM.\n\t\t\t\t\tdocument.body.appendChild( tooltip );\n\n\t\t\t\t\t// Position tooltip if off screen.\n\t\t\t\t\tconst tooltipRect = tooltip.getBoundingClientRect();\n\t\t\t\t\tif ( tooltipRect.right > window.innerWidth ) {\n\t\t\t\t\t\ttooltip.style.left =\n\t\t\t\t\t\t\ttooltipLeft - ( tooltipRect.right - window.innerWidth ) + 'px';\n\t\t\t\t\t} else if ( tooltipRect.left < 0 ) {\n\t\t\t\t\t\ttooltip.style.left = tooltipLeft - tooltipRect.left + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif ( tooltipRect.bottom > window.innerHeight ) {\n\t\t\t\t\t\ttooltip.style.top =\n\t\t\t\t\t\t\ttooltipTop - ( tooltipRect.bottom - window.innerHeight ) + 'px';\n\t\t\t\t\t} else if ( tooltipRect.top < 0 ) {\n\t\t\t\t\t\ttooltip.style.top = tooltipTop - tooltipRect.top + 'px';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t\telement.addEventListener( 'mouseout', () => {\n\t\t\t\t// Hide the tooltip.\n\t\t\t\tconst tooltip = document.querySelectorAll( '.has-inline-text-tooltip' );\n\t\t\t\tif ( null !== tooltip ) {\n\t\t\t\t\ttooltip.forEach( ( element ) => {\n\t\t\t\t\t\telement.classList.add( 'has-fade-out' );\n\t\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t\telement.remove();\n\t\t\t\t\t\t}, 900 );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// Get click to share block elements.\n\tconst ctsElements = document.querySelectorAll( '.has-click-prompt' );\n\tif ( null !== ctsElements ) {\n\t\tctsElements.forEach( ( element ) => {\n\t\t\telement.addEventListener( 'click', ( event ) => {\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\t// Remove any visible elements.\n\t\t\t\thasRemoveVisibleElements();\n\n\t\t\t\t// Exit early if the element is already visible (works like a toggle).\n\t\t\t\tif ( element === currentElement ) {\n\t\t\t\t\tcurrentElement = null;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcurrentElement = element;\n\n\t\t\t\t// Get parent element of prompt.\n\t\t\t\tconst ctsTextElement = element.parentNode.querySelector(\n\t\t\t\t\t'.has-click-to-share-text'\n\t\t\t\t);\n\n\t\t\t\t// Get text.\n\t\t\t\tconst selectedText = ctsTextElement.getAttribute( 'data-text-full' );\n\n\t\t\t\tconst parentElement = element.closest( '.has-social-placeholder' );\n\t\t\t\tconst { href, title, hashtags } = getPageParams( parentElement );\n\n\t\t\t\t/**\n\t\t\t\t * See if we can launch the web share API by default on inline highlight click.\n\t\t\t\t */\n\t\t\t\tconst webshareDefaultClickToShare = HAS.enable_webshare_click_to_share;\n\t\t\t\tif ( webshareDefaultClickToShare ) {\n\t\t\t\t\t// Check if navigator.share is available.\n\t\t\t\t\tif ( typeof navigator.share === 'function' ) {\n\t\t\t\t\t\tnavigator.share( {\n\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\turl: href,\n\t\t\t\t\t\t\ttext: selectedText,\n\t\t\t\t\t\t} );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Display Highlight and Share.\n\t\t\t\thasDisplay(\n\t\t\t\t\tselectedText,\n\t\t\t\t\ttitle,\n\t\t\t\t\thref,\n\t\t\t\t\thashtags,\n\t\t\t\t\t'cta',\n\t\t\t\t\telement.closest( '.has-click-to-share' )\n\t\t\t\t);\n\t\t\t} );\n\t\t} );\n\t}\n}() );\n"],"names":["HAS","highlight_and_share","prefix","suffix","isLegacyContentMode","content_legacy_mode","currentElement","hasContainer","document","querySelector","socialNetworks","hasSharingIconsContainer","rect","getBoundingClientRect","hasSharerWidth","width","hasSharerHeight","height","isVisible","element","style","window","getComputedStyle","display","visibility","opacity","hasRemoveVisibleElements","hasContainers","querySelectorAll","forEach","container","closest","remove","hasVariableReplace","url","title","text","hashtags","type","queryElements","triggerType","el","elementAnchor","elementUrl","getAttribute","replace","encodeURIComponent","twitter_username","setAttribute","title_attr","url_attr","hasDisplay","href","triggerElement","arguments","length","undefined","show_twitter","show_facebook","show_linkedin","show_ok","show_vk","show_pinterest","show_email","show_webshare","show_mastodon","hasClone","cloneNode","position","classList","contains","navigator","share","webshare","body","appendChild","setHasContainerPositionSelection","setHasContainerPositionInline","setHasContainerPositionCta","addEventListener","event","preventDefault","dataLayer","push","hasShareText","hasSharePostUrl","hasSharePostTitle","hasShareType","hasSocialNetwork","open","copyButtons","ClipboardItem","copyBlob","Blob","data","_defineProperty","clipboard","write","e","emailButtons","target","Fancybox","highlightShareFancy","src","preload","compact","autoFocus","Toolbar","autoEnable","mastodonButtons","on","done","fancyboxForm","fancyboxInput","focus","fancyboxInputValue","value","localStorage","setItem","fancyUrl","console","log","localStorageValue","getItem","webshareButtons","windowWidth","innerWidth","windowHeight","innerHeight","selectionRect","getSelection","getRangeAt","selectionTop","top","selectionLeft","left","selectionWidth","selectionHeight","offsetWidth","maxWidth","add","hasCloneRect","hasCloneWidth","hasCloneHeight","hasSharerX","scrollX","hasSharerY","scrollY","gridTemplateColumns","newCloneRect","right","inlineRect","inlineTop","inlineLeft","inlineWidth","inlineHeight","leftPosition","ctaRect","ctaTop","ctaLeft","ctaWidth","ctaHeight","getPageParams","newElement","dataset","location","params","jsContent","content","elements","hasHandleSelectEvents","parentElement","selection","defaultView","selectedText","toString","trim","_getPageParams","inlineElements","hasHandleInlineEvents","innerText","elementParent","_getPageParams2","webshareDefaultInlineHighlight","enable_webshare_inline_highlight","inline_highlight_tooltips_enabled","inline_highlight_tooltips_text","tooltip","tooltipElement","hasAttribute","elementRect","elementTop","tooltipWidth","tooltipHeight","tooltipLeft","clientX","tooltipTop","createElement","tooltipRect","bottom","setTimeout","ctsElements","ctsTextElement","parentNode","_getPageParams3","webshareDefaultClickToShare","enable_webshare_click_to_share"],"sourceRoot":""}