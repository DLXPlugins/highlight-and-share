(function(g,m,r){"function"===typeof define&&define.amd?define(["jquery"],function(q){r(q,g,m);return q.mobile}):r(g.jQuery,g,m)})(this,document,function(g,m,r,q){(function(e,g,m,r){function v(a){for(;a&&"undefined"!==typeof a.originalEvent;)a=a.originalEvent;return a}function x(a){for(var c={},b,d;a;){b=e.data(a,"virtualMouseBindings");for(d in b)b[d]&&(c[d]=c.hasVirtualBinding=!0);a=a.parentNode}return c}function q(){n&&(clearTimeout(n),n=0);n=setTimeout(function(){t=n=0;y.length=0;A=!1;u=!0},e.vmouse.resetTimerDuration)}
function l(a,c,b){var d,h;if(!(h=b&&b[a])){if(b=!b)a:{for(b=c.target;b;){if((h=e.data(b,"virtualMouseBindings"))&&(!a||h[a]))break a;b=b.parentNode}b=null}h=b}if(h){d=c;b=d.type;var f,g;d=e.Event(d);d.type=a;a=d.originalEvent;h=e.event.props;-1<b.search(/^(mouse|click)/)&&(h=N);if(a)for(g=h.length,f;g;)f=h[--g],d[f]=a[f];-1<b.search(/mouse(down|up)|click/)&&!d.which&&(d.which=1);if(-1!==b.search(/^touch/)&&(f=v(a),b=f.touches,f=f.changedTouches,a=b&&b.length?b[0]:f&&f.length?f[0]:r))for(b=0,h=D.length;b<
h;b++)f=D[b],d[f]=a[f];e(c.target).trigger(d)}return d}function E(a){var c=e.data(a.target,"virtualTouchID");A||t&&t===c||!(c=l("v"+a.type,a))||(c.isDefaultPrevented()&&a.preventDefault(),c.isPropagationStopped()&&a.stopPropagation(),c.isImmediatePropagationStopped()&&a.stopImmediatePropagation())}function F(a){var c=v(a).touches,b;c&&1===c.length&&(b=a.target,c=x(b),c.hasVirtualBinding&&(t=O++,e.data(b,"virtualTouchID",t),n&&(clearTimeout(n),n=0),p=u=!1,b=v(a).touches[0],G=b.pageX,H=b.pageY,l("vmouseover",
a,c),l("vmousedown",a,c)))}function I(a){u||(p||l("vmousecancel",a,x(a.target)),p=!0,q())}function J(a){if(!u){var c=v(a).touches[0],b=p,d=e.vmouse.moveDistanceThreshold,h=x(a.target);(p=p||Math.abs(c.pageX-G)>d||Math.abs(c.pageY-H)>d)&&!b&&l("vmousecancel",a,h);l("vmousemove",a,h);q()}}function K(a){if(!u){u=!0;var c=x(a.target),b;l("vmouseup",a,c);p||(b=l("vclick",a,c))&&b.isDefaultPrevented()&&(b=v(a).changedTouches[0],y.push({touchID:t,x:b.clientX,y:b.clientY}),A=!0);l("vmouseout",a,c);p=!1;q()}}
function L(a){a=e.data(a,"virtualMouseBindings");var c;if(a)for(c in a)if(a[c])return!0;return!1}function M(){}function P(a){var c=a.substr(1);return{setup:function(){L(this)||e.data(this,"virtualMouseBindings",{});e.data(this,"virtualMouseBindings")[a]=!0;k[a]=(k[a]||0)+1;1===k[a]&&z.bind(c,E);e(this).bind(c,M);B&&(k.touchstart=(k.touchstart||0)+1,1===k.touchstart&&z.bind("touchstart",F).bind("touchend",K).bind("touchmove",J).bind("scroll",I))},teardown:function(){--k[a];k[a]||z.unbind(c,E);B&&(--k.touchstart,
k.touchstart||z.unbind("touchstart",F).unbind("touchmove",J).unbind("touchend",K).unbind("scroll",I));var b=e(this),d=e.data(this,"virtualMouseBindings");d&&(d[a]=!1);b.unbind(c,M);L(this)||b.removeData("virtualMouseBindings")}}}g="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" ");var D="clientX clientY pageX pageY screenX screenY".split(" "),N=e.event.props.concat(e.event.mouseHooks?e.event.mouseHooks.props:[]),k={},n=0,G=0,H=0,p=!1,y=[],A=!1,u=!1,B="addEventListener"in
m,z=e(m),O=1,t=0,C,w;e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(w=0;w<g.length;w++)e.event.special[g[w]]=P(g[w]);B&&m.addEventListener("click",function(a){var c=y.length,b=a.target,d,h,f,g,k;if(c)for(d=a.clientX,h=a.clientY,C=e.vmouse.clickDistanceThreshold,f=b;f;){for(g=0;g<c;g++)if(k=y[g],f===b&&Math.abs(k.x-d)<C&&Math.abs(k.y-h)<C||e.data(f,"virtualTouchID")===k.touchID){a.preventDefault();a.stopPropagation();return}f=f.parentNode}},!0)})(g,m,r)});